#!/usr/bin/env sh

alias yc='yabai -m config'
alias yr='yabai -m rule --add'
alias ys='yabai -m signal --add'

# global settings
yc mouse_follows_focus          off
yc focus_follows_mouse          off
yc window_placement             second_child
yc window_topmost               off
yc window_shadow                on
yc window_opacity               off
yc window_opacity_duration      0.0
yc active_window_opacity        1.0
yc normal_window_opacity        0.90
yc window_border                on
yc window_border_width          6
yc active_window_border_color   0xff775759
yc normal_window_border_color   0xff505050
yc insert_feedback_color        0xffd75f5f
yc split_ratio                  0.50
yc auto_balance                 off
yc mouse_modifier               fn
yc mouse_action1                move
yc mouse_action2                resize
yc mouse_drop_action            swap

# general space settings
yc layout                       bsp
yc top_padding                  12
yc bottom_padding               12
yc left_padding                 12                 
yc right_padding                12 
yc window_gap                   06
yc external_bar                 main:20:0

# yabai rules
yr title='Preferences$' manage=off layer=above
yr title='Opening$' manage=off layer=above
yr app='System Preferences' manage=off layer=above
yr app='App Store' manage=off layer=above
yr app='IINA' manage=off layer=above
yr app='Finder' manage=off layer=above
yr app='Keka' manage=off layer=above
yr app='Contexts' manage=off layer=above

yr app='Discord' space=5
yr app='Spotify' space=6

# yabai signals
ys event=window_destroyed action="yabai -m query --windows --window &> /dev/null || yabai -m window --focus mouse"
ys event=application_terminated action="yabai -m query --windows --window &> /dev/null || yabai -m window --focus mouse"

ys event=space_changed \
    action="osascript -e 'tell application \"Übersicht\" to refresh widget id \"nibar-spaces-jsx\"'"

# if using multple displays, add an additional rule for "display_changed" event
ys event=display_changed \
    action="osascript -e 'tell application \"Übersicht\" to refresh widget id \"nibar-spaces-jsx\"'"
ys event=window_focused \
    action="osascript -e 'tell application \"Übersicht\" to refresh widget id \"nibar-windows-jsx\"'"
ys event=window_destroyed \
    action="osascript -e 'tell application \"Übersicht\" to refresh widget id \"nibar-windows-jsx\"'"
ys event=window_created \
    action="osascript -e 'tell application \"Übersicht\" to refresh widget id \"nibar-windows-jsx\"'"
ys event=space_changed \
    action="osascript -e 'tell application \"Übersicht\" to refresh widget id \"nibar-windows-jsx\"'"

echo "yabai configuration loaded.."
